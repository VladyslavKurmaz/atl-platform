module.exports = {
  tags: (tln) => [],
  options: (tln, options) => {},
  dotenvs: (tln) => ['.env'],
  depends: (tln) => [],
  inherits: (tln) => ['sdlc'],
  variables: (tln, variables) => {/*
    // params.name, params.env 
    variables
      .set('TLN_GIT_USER', (tln, params) => 'user.name')
      .append('PATH', (tln, params) => path.join(params.env['COMPONENT_ORIGIN'], 'lib'))
      .prepend('PATH', (tln, params) => path.join(params.env['COMPONENT_ORIGIN'], 'bin'));
  */},
  steps: (tln) => [
    {
      id: 'docker-build',
      filter: 'linux',
      script: (tln, script) => script.set([
        'docker build -t ${COMPONENT_ID}:${COMPONENT_VERSION} .'
      ])
    },
    {
      id: 'docker-run',
      filter: 'linux',
      script: (tln, script) => script.set([
        'docker run -d --rm \\',
        ' -p ${COMPONENT_PARAM_PORT}:${COMPONENT_PARAM_PORT} \\',
        ' -e MONGO_INITDB_ROOT_USERNAME=${COMPONENT_PARAM_DB_ROOT_USER} \\',
        ' -e MONGO_INITDB_ROOT_PASSWORD=${COMPONENT_PARAM_DB_ROOT_PASS} \\',
        ' -v ${COMPONENT_PARAM_DB_VOLUME}:/data/db \\',
        ' -e MONGO_INITDB_DATABASE=${COMPONENT_PARAM_DB_NAME} \\',
        ' --name ${COMPONENT_ID} ${COMPONENT_ID}:${COMPONENT_VERSION}'
      ])
    },
    {
      id: 'docker-stop',
      filter: 'linux',
      script: (tln, script) => script.set([
        'docker stop ${COMPONENT_ID}'
      ])
    },
    {
      id: 'mongo-run-cli',
      filter: 'linux',
      script: (tln, script) => script.set([
        'docker exec -it ${COMPONENT_ID} mongo -u ${COMPONENT_PARAM_DB_ROOT_USER} -p ${COMPONENT_PARAM_DB_ROOT_PASS}'
      ])
    }
  ],
  components: (tln) => []
}